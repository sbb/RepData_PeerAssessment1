---
title: 'Reproducible Research: Peer Assessment 1'
output:
  html_document:
    keep_md: yes
  pdf_document: default
---


## Loading and preprocessing the data

```{r loaddata, echo=TRUE, cache=TRUE}

data <- read.csv("activity.csv")

```

## What is mean total number of steps taken per day?

First, compute the total number of steps per day, excluding missing values
```{r echo = TRUE}
library(ggplot2)
```

```{r meanstepsperday, echo=TRUE}
raw.data <- read.csv("activity.csv")

data <- raw.data[!is.na(raw.data$steps),]

steps.by.date <- aggregate(steps ~ date, data = data, FUN = sum)
```

A histogram of the steps per day shows the distribution:

```{r meanstepshistogram, echo=TRUE}

p <- ggplot(steps.by.date, aes(x=steps)) +  geom_histogram(binwidth = 1000, fill="blue")  + 
  labs(title = "Histogram showing steps per day frequencies", 
       x = "Steps per day",
       y = "Frequency of occurrence")

print(p)
```

### Mean and median steps taken per day

The mean number of steps taken per day is `r format(mean(steps.by.date$steps))`.

The median number of steps taken per day is `r format(median(steps.by.date$steps))`

## What is the average daily activity pattern?


```{r averageDailyActivityPattern, echo=TRUE}
average.steps <- aggregate(steps ~ interval, data = data, FUN = mean)

p <- ggplot(average.steps, aes(x = interval, y = steps)) + 
  geom_line() +
  labs(title = "Average number of steps, by interval during the day", 
       x = "Interval in the day", y = "Average number of steps")

print(p)
```

The interval with the maximum average number of steps is calculated by:
```{r maxAverageSteps, echo+TRUE}
average.steps.max <- average.steps[which.max(average.steps$steps),]
max.interval <- average.steps.max$interval

# compute values for showing the time of day when the max interval occurred
# Intervals are hours * 100 + minutes
max.interval.hour <- floor(max.interval/100)
max.interval.min <- max.interval %% 100
max.interval.time <- sprintf("%d:%02d %s", max.interval.hour, 
  max.interval.min, if(max.interval.hour >= 12) "pm" else "am")
```

And its value is `r max.interval`, or `r max.interval.time`.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
